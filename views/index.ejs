<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> - API Documentation</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --primary: #667eea;
      --secondary: #764ba2;
      --success: #48bb78;
      --danger: #f56565;
      --warning: #ed8936;
      --info: #4299e1;
      --dark: #2d3748;
      --light: #f7fafc;
      --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      line-height: 1.6;
      color: var(--dark);
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
    }
    
    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .header .status {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.2);
      padding: 8px 16px;
      border-radius: 25px;
      backdrop-filter: blur(10px);
    }
    
    .auth-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .auth-card {
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.3);
      text-align: center;
      max-width: 400px;
      width: 90%;
    }
    
    .auth-card h2 {
      margin-bottom: 20px;
      color: var(--dark);
    }
    
    .auth-input {
      width: 100%;
      padding: 15px;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 16px;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }
    
    .auth-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .auth-btn {
      width: 100%;
      padding: 15px;
      background: var(--gradient);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    
    .auth-btn:hover {
      transform: translateY(-2px);
    }
    
    .main-content {
      display: none;
    }
    
    .welcome-card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      margin-bottom: 30px;
      text-align: center;
    }
    
    .user-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--gradient);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      margin: 0 auto 20px;
      font-weight: bold;
    }
    
    .api-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
    }
    
    .api-section {
      background: white;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    
    .api-section:hover {
      transform: translateY(-5px);
    }
    
    .api-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .api-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
    }
    
    .public { background: var(--success); }
    .auth { background: var(--info); }
    .admin { background: var(--danger); }
    
    .endpoint {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 8px;
      border-left: 4px solid var(--primary);
      font-family: 'Fira Code', monospace;
      font-size: 14px;
    }
    
    .method {
      font-weight: bold;
      padding: 2px 8px;
      border-radius: 4px;
      margin-right: 8px;
    }
    
    .get { background: var(--success); color: white; }
    .post { background: var(--info); color: white; }
    .put { background: var(--warning); color: white; }
    .delete { background: var(--danger); color: white; }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: white;
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
    
    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary);
    }
    
    .collapsible {
      cursor: pointer;
      user-select: none;
    }
    
    .collapsible:hover {
      opacity: 0.8;
    }
    
    .collapsible-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    
    .collapsible-content.active {
      max-height: 1000px;
    }
    
    .footer {
      text-align: center;
      margin-top: 40px;
      color: white;
      opacity: 0.8;
    }
    
    @media (max-width: 768px) {
      .container { padding: 15px; }
      .header h1 { font-size: 2rem; }
      .api-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div id="authModal" class="auth-modal">
    <div class="auth-card">
      <i class="fas fa-shield-alt" style="font-size: 3rem; color: var(--primary); margin-bottom: 20px;"></i>
      <h2>API Access Required</h2>
      <p style="margin-bottom: 25px; color: #666;">Enter the secret key to view API documentation</p>
      <input type="password" id="secretKey" class="auth-input" placeholder="Enter secret key..." maxlength="50">
      <button onclick="checkAccess()" class="auth-btn">
        <i class="fas fa-unlock"></i> Unlock Documentation
      </button>
      <div id="errorMsg" style="color: var(--danger); margin-top: 10px; display: none;">
        <i class="fas fa-exclamation-triangle"></i> Invalid secret key
      </div>
    </div>
  </div>

  <div id="mainContent" class="main-content">
    <div class="container">
      <div class="header">
        <h1><i class="fas fa-rocket"></i> <%= title %></h1>
        <div class="status">
          <i class="fas fa-circle" style="color: var(--success);"></i>
          <span>API Status: Operational</span>
        </div>
      </div>

      <div class="welcome-card">
        <div class="user-avatar">
          <i class="fas fa-user-shield"></i>
        </div>
        <h2>Welcome to UniShare API</h2>
        <p>Complete API documentation for the UniShare platform</p>
      </div>

      <div class="stats">
        <div class="stat-card">
          <div class="stat-number">9</div>
          <div>API Modules</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">50+</div>
          <div>Endpoints</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">3</div>
          <div>Access Levels</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">100%</div>
          <div>Uptime</div>
        </div>
      </div>

      <div class="api-grid">
        <!-- Public APIs -->
        <div class="api-section">
          <div class="api-header collapsible" onclick="toggleSection('public')">
            <div class="api-icon public"><i class="fas fa-globe"></i></div>
            <h3>Public APIs <i class="fas fa-chevron-down"></i></h3>
          </div>
          <div id="public" class="collapsible-content">
            <div class="endpoint">
              <span class="method get">GET</span> /api/notice - View active notices
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/announcements - Browse announcements
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/announcements/:id - Get specific announcement
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/contacts - View emergency contacts
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/contacts/search/:term - Search contacts
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/resources - Browse academic resources
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/rooms - Browse available rooms
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/itemsell - Browse items for sale
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/ticketsell - Browse tickets for sale
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/shareride - Browse available rides
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /api/lostfound - Browse lost & found items
            </div>
          </div>
        </div>

        <!-- Authenticated User APIs -->
        <div class="api-section">
          <div class="api-header collapsible" onclick="toggleSection('auth')">
            <div class="api-icon auth"><i class="fas fa-user"></i></div>
            <h3>User APIs <i class="fas fa-chevron-down"></i></h3>
          </div>
          <div id="auth" class="collapsible-content">
            <h4>Resources Management</h4>
            <div class="endpoint">
              <span class="method get">GET</span> /api/resources/my - My resources
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/resources/suggest - Suggest resource
            </div>
            <div class="endpoint">
              <span class="method put">PUT</span> /api/resources/my/:id - Update resource
            </div>
            <div class="endpoint">
              <span class="method delete">DELETE</span> /api/resources/my/:id - Delete resource
            </div>
            
            <h4>Room Listings</h4>
            <div class="endpoint">
              <span class="method get">GET</span> /api/rooms/mine - My room listings
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/rooms - Create room listing
            </div>
            <div class="endpoint">
              <span class="method put">PUT</span> /api/rooms/:id - Update room listing
            </div>
            <div class="endpoint">
              <span class="method delete">DELETE</span> /api/rooms/:id - Delete room listing
            </div>

            <h4>Item Selling</h4>
            <div class="endpoint">
              <span class="method get">GET</span> /api/itemsell/mine - My items for sale
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/itemsell - Create item listing
            </div>
            <div class="endpoint">
              <span class="method put">PUT</span> /api/itemsell/:id - Update item
            </div>
            <div class="endpoint">
              <span class="method delete">DELETE</span> /api/itemsell/:id - Delete item
            </div>

            <h4>Ride Sharing</h4>
            <div class="endpoint">
              <span class="method get">GET</span> /api/shareride/my - My ride offers
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/shareride/create - Create ride offer
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/shareride/:id/request - Request ride
            </div>
            <div class="endpoint">
              <span class="method put">PUT</span> /api/shareride/requests/:id/respond - Respond to request
            </div>

            <h4>Lost & Found</h4>
            <div class="endpoint">
              <span class="method get">GET</span> /api/lostfound/my - My lost/found posts
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/lostfound/create - Report item
            </div>
            <div class="endpoint">
              <span class="method post">POST</span> /api/lostfound/:id/contact - Contact about item
            </div>
          </div>
        </div>

        <!-- Admin APIs -->
        <div class="api-section">
          <div class="api-header collapsible" onclick="toggleSection('admin')">
            <div class="api-icon admin"><i class="fas fa-crown"></i></div>
            <h3>Admin APIs <i class="fas fa-chevron-down"></i></h3>
          </div>
          <div id="admin" class="collapsible-content">
            <p><strong>Full CRUD operations on all modules:</strong></p>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/announcements - Manage announcements
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/contacts - Manage contacts
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/itemsell - Manage items
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/lostfound - Manage lost/found
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/notice - Manage notices
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/resources - Manage resources
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/rooms - Manage rooms
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/shareride - Manage rides
            </div>
            <div class="endpoint">
              <span class="method get">GET</span> /admin/ticketsell - Manage tickets
            </div>
          </div>
        </div>

        <!-- Authentication -->
        <div class="api-section">
          <div class="api-header">
            <div class="api-icon" style="background: var(--dark);"><i class="fas fa-key"></i></div>
            <h3>Authentication</h3>
          </div>
          <div class="endpoint">
            <span class="method post">POST</span> /auth/login - User login
          </div>
          <div class="endpoint">
            <span class="method post">POST</span> /auth/register - User registration
          </div>
          <div class="endpoint">
            <span class="method post">POST</span> /auth/logout - User logout
          </div>
          <div class="endpoint">
            <span class="method get">GET</span> /auth/profile - Get user profile
          </div>
        </div>
      </div>

      <div class="footer">
        <p><i class="fas fa-code"></i> UniShare Backend API v1.0 | Powered by Node.js & Express</p>
      </div>
    </div>
  </div>

  <script>
    const SECRET_KEY = "<%= process.env.SYSTEM_SECRET %>";
    
    function checkAccess() {
      const input = document.getElementById('secretKey').value;
      const errorMsg = document.getElementById('errorMsg');
      
      if (input === SECRET_KEY) {
        document.getElementById('authModal').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
        sessionStorage.setItem('apiAccess', 'granted');
      } else {
        errorMsg.style.display = 'block';
        setTimeout(() => {
          errorMsg.style.display = 'none';
        }, 3000);
      }
    }
    
    function toggleSection(sectionId) {
      const section = document.getElementById(sectionId);
      const isActive = section.classList.contains('active');
      
      // Close all sections
      document.querySelectorAll('.collapsible-content').forEach(el => {
        el.classList.remove('active');
      });
      
      // Open clicked section if it wasn't active
      if (!isActive) {
        section.classList.add('active');
      }
    }
    
    // Check if user already has access
    if (sessionStorage.getItem('apiAccess') === 'granted') {
      document.getElementById('authModal').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
    }
    
    // Enter key support for secret key input
    document.getElementById('secretKey').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        checkAccess();
      }
    });
    
    // Auto-expand first section
    setTimeout(() => {
      document.getElementById('public').classList.add('active');
    }, 500);
  </script>
</body>
</html>